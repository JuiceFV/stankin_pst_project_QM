version: '3.8'

services:
    db:
        image: postgres
        volumes:
            - ./application/sources/database/:/docker-entrypoint-initdb.d/
        environment:
            - POSTGRES_DB=catsqms
            - POSTGRES_USER=postgres
            - POSTGRES_PASSWORD=1234

    application:
        build: .
        image: application
        command: sh -c './wait-for db:5432 -- python3 application/entry.py -t --host 0.0.0.0 -c application/config.yaml'
        ports:
            - "8080:5000"
        depends_on:
            - db